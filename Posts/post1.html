<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
<div class="included" src="styles.html"></div>


<div role="main">

<h1 id="xor">XOR</h1>
<h2>Data Representation</h2>
<p>Data can be represented in different bases, an 'A' needs to be a numerical representation of Base 2 or binary so computers can understand them</p>
<p><img alt="Data Representation" src="../images/data-representation.png" data-action="zoom"></p>
<h2 id="xor-basics">XOR Basics<a class="headerlink" href="#xor-basics" title="Permanent link">¶</a></h2>
<p>An XOR or <em>eXclusive OR</em> is a bitwise operation indicated by <code class="codehilite">^</code> and shown by the following truth table:</p>
<table class="table table-striped table-hover">
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>A ^ B</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>So what XOR'ing bytes in the action <code class="codehilite">0xA0 ^ 0x2C</code> translates to is:</p>
<table class="table table-striped table-hover">
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover">
<thead>
<tr>
<th>1</th>
<th>0</th>
<th>0</th>
<th>0</th>
<th>1</th>
<th>1</th>
<th>0</th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><code class="codehilite">0b10001100</code> is equivelent to <code class="codehilite">0x8C</code>, a cool property of XOR is that it is reversable meaning <code class="codehilite">0x8C ^ 0x2C = 0xA0</code> and <code class="codehilite">0x8C ^ 0xA0 = 0x2C</code></p>
<p><img alt="XOR Basics" src="../images/xor.png" data-action="zoom"></p>
<h2 id="what-does-this-have-to-do-with-ctf">What does this have to do with CTF?<a class="headerlink" href="#what-does-this-have-to-do-with-ctf" title="Permanent link">¶</a></h2>
<p>XOR is a cheap way to encrypt data with a password. Any data can be encrypted using XOR as shown in this Python example:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'CAPTURETHEFLAG'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">'A'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">encrypted</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">encrypted</span>
<span class="s1">'</span><span class="se">\x02\x00\x11\x15\x14\x13\x04\x15\t\x04\x07\r\x00\x06</span><span class="s1">'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">decrypted</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">encrypted</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">decrypted</span>
<span class="s1">'CAPTURETHEFLAG'</span>
</pre></div>


<p>This can be extended using a multibyte key by iterating in parallel with the data.</p>
<h2 id="exploiting-xor-encryption">Exploiting XOR Encryption<a class="headerlink" href="#exploiting-xor-encryption" title="Permanent link">¶</a></h2>
<h3 id="single-byte-xor-encryption">Single Byte XOR Encryption<a class="headerlink" href="#single-byte-xor-encryption" title="Permanent link">¶</a></h3>
<p>Single Byte XOR Encryption is trivial to bruteforce as there are only 255 key combinations to try.</p>
<h3 id="multibyte-xor-encryption">Multibyte XOR Encryption<a class="headerlink" href="#multibyte-xor-encryption" title="Permanent link">¶</a></h3>
<p>Multibyte XOR gets exponentially harder the longer the key, but if the encrypted text is long enough, character frequency analysis is a viable method to find the key. Character Frequency Analysis means that we split the cipher text into groups based on the number of characters in the key. These groups then are bruteforced using the idea that some letters appear more frequently in the english alphabet than others.</p></div>


<div class="included" src="include.html"></div>
<script>
elmnts = document.getElementsByClassName("included");
for (index = 0; index < elmnts.length; index++) {
     elmnt= elmnts[index];
     $(elmnt).load(elmnt.getAttribute("src"));
}                                   
</script>
